<!DOCTYPE html>
<html>

<body>
    <div class="container">
        <!-- Dish rating section -->
        <div class="row">
            <div class="col-sm-4 text-center">
                <div class="rating-block">
                    <h5>Average rating</h5>
                    <h2 class="bold padding-bottom-5">{{productRating?.avg_rate | number}} <span>/ 5</span></h2>
                    <bar-rating [rate]="productRating?.avg_rate" [max]="5" [theme]="'fontawesome'" [readOnly]="true" class="d-flex justify-content-center"></bar-rating>
                    <p>{{productRating?.count_rate}} reviews</p>
                </div>
            </div>
            <div class="col-sm-4 rating-overall">
                <div class="pull-left">
                    <div class="pull-left" style="width:35px; line-height:1;">
                        <div style="height:9px; margin:5px 0;">5 <span class="fa fa-star"></span></div>
                    </div>
                    <div class="pull-left" style="width:180px;">
                        <div class="progress" style="height:9px; margin:8px 0;">
                            <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="reviewOverall.five"
                                aria-valuemin="0" aria-valuemax="productRating?.count_rate" [ngStyle]="{width: reviewOverall.five/productRating?.count_rate*100 +'%'}">
                                <!-- <span class="sr-only">80% Complete (danger)</span> -->
                            </div>
                        </div>
                    </div>
                    <div class="pull-right" style="margin-left:10px;">{{reviewOverall.five/productRating?.count_rate*100 || "0" | number:'1.0-0'}}%</div>
                </div>
                <div class="pull-left">
                    <div class="pull-left" style="width:35px; line-height:1;">
                        <div style="height:9px; margin:5px 0;">4 <span class="fa fa-star"></span></div>
                    </div>
                    <div class="pull-left" style="width:180px;">
                        <div class="progress" style="height:9px; margin:8px 0;">
                            <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuenow="reviewOverall.four"
                                aria-valuemin="0" aria-valuemax="productRating?.count_rate" [ngStyle]="{width: reviewOverall.four/productRating?.count_rate*100 +'%'}">
                                <!-- <span class="sr-only">80% Complete (danger)</span> -->
                            </div>
                        </div>
                    </div>
                    <div class="pull-right" style="margin-left:10px;">{{reviewOverall.four/productRating?.count_rate*100 || "0" | number:'1.0-0'}}%</div>
                </div>
                <div class="pull-left">
                    <div class="pull-left" style="width:35px; line-height:1;">
                        <div style="height:9px; margin:5px 0;">3 <span class="fa fa-star"></span></div>
                    </div>
                    <div class="pull-left" style="width:180px;">
                        <div class="progress" style="height:9px; margin:8px 0;">
                            <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="reviewOverall.three"
                                aria-valuemin="0" aria-valuemax="productRating?.count_rate" [ngStyle]="{width: reviewOverall.three/productRating?.count_rate*100 +'%'}">
                                <!-- <span class="sr-only">80% Complete (danger)</span> -->
                            </div>
                        </div>
                    </div>
                    <div class="pull-right" style="margin-left:10px;">{{reviewOverall.three/productRating?.count_rate*100 || "0" | number:'1.0-0'}}%</div>
                </div>
                <div class="pull-left">
                    <div class="pull-left" style="width:35px; line-height:1;">
                        <div style="height:9px; margin:5px 0;">2 <span class="fa fa-star"></span></div>
                    </div>
                    <div class="pull-left" style="width:180px;">
                        <div class="progress" style="height:9px; margin:8px 0;">
                            <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="reviewOverall.two"
                                aria-valuemin="0" aria-valuemax="productRating?.count_rate" [ngStyle]="{width: reviewOverall.two/productRating?.count_rate*100 +'%'}">
                                <!-- <span class="sr-only">80% Complete (danger)</span> -->
                            </div>
                        </div>
                    </div>
                    <div class="pull-right" style="margin-left:10px;">{{reviewOverall.two/productRating?.count_rate*100 || "0" | number:'1.0-0'}}%</div>
                </div>
                <div class="pull-left">
                    <div class="pull-left" style="width:35px; line-height:1;">
                        <div style="height:9px; margin:5px 0;">1 <span class="fa fa-star"></span></div>
                    </div>
                    <div class="pull-left" style="width:180px;">
                        <div class="progress" style="height:9px; margin:8px 0;">
                            <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="reviewOverall.one"
                                aria-valuemin="0" aria-valuemax="productRating?.count_rate" [ngStyle]="{width: reviewOverall.one/productRating?.count_rate*100 +'%'}">
                                <!-- <span class="sr-only">80% Complete (danger)</span> -->
                            </div>
                        </div>
                    </div>
                    <div class="pull-right" style="margin-left:10px;">{{reviewOverall.one/productRating?.count_rate*100 || "0" | number:'1.0-0'}}%</div>
                </div>
            </div>
            <div class="col-sm-4 text-center">
                <h6>Write your review</h6>
                <button id="reviewbtn" type="button" data-toggle="collapse" data-target="#ratingField" class="btn btn-default btn-block" [disabled]="!authenticationService.loggedIn()">Review</button>
            </div>
            <div class="col-sm-12">
                <div class="collapse" id="ratingField">
                    <form #rating = "ngForm" (ngSubmit)="ratingSubmit(rating.value)" id="ratingForm" class="row">
                        <div class="col-sm-12">
                            <h6 class="sub-title">Your review</h6>
                            <textarea class="form-control animated" cols="50" id="new-review" name="comment" placeholder = "Write review..." rows="5" ngModel required></textarea>
                        </div>
                        <div class="col-sm-12">
                            <h6 style="margin-top: 1em">Your rating</h6>
                            <bar-rating [(rate)]="rate" [max]="5" [theme]="'fontawesome'" name=rating ngModel required></bar-rating>
                        </div>
                        <div class="col align-self-end">
                            <button class="btn btn-success" type="submit" [disabled]="rating.invalid">Send</button>
                        </div>
                    </form>
                  </div>
            </div>
        </div>
        <!-- User review and rating section -->
        <div class="row">
            <div class="col-sm-12">
                <hr *ngIf="productRating?.count_rate != 0">
                <div class="review-block" *ngIf="productRating?.count_rate != 0">
                    <div *ngFor="let review of productRating?.list_rate; let i = index">
                        <div class="row review-item" *ngIf="i<11">
                            <div class="col-sm-3 text-center">
                            <img src={{review.imageurl}} onError="this.src='http://dummyimage.com/60x60/666/ffffff&text=No+Image';" class="img-rounded avt-thumb">
                                <div class="review-block-name"><a>{{review.user_rate}}</a></div>
                                <div class="review-block-date">{{review.create_at | date: 'dd-MM-yyyy hh:mm a'}}</div>
                            </div>
                            <div class="col-sm-9">
                                <div class="review-block-rate">
                                    <bar-rating [rate]="review.score" [max]="5" [theme]="'fontawesome'" [readOnly]="true"></bar-rating>
                                </div>
                                <!-- <div class="review-block-title">this was nice in buy</div> -->
                                <div class="review-block-description">{{review.comment}}</div>
                            </div>
                        </div>
                        <hr *ngIf="i!=productRating?.list_rate.length-1 && i<11">                       
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>